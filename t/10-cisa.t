#!perl -T

use v5.10;
use Test::More;

use_ok('SSVC::CISA');

while (my $vector_string = <DATA>) {

    chomp($vector_string);

    my $ssvc = eval { SSVC::CISA->from_vector_string($vector_string) };

    fail($@) if $@;

    my $got      = substr($ssvc->to_vector_string, 0, 34);
    my $expected = substr($vector_string,          0, 34);

    is($got, $expected, "$vector_string") or diag explain $ssvc;

}

done_testing();

__DATA__
SSVCv2/E:N/A:N/T:P/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:M/B:I/M:H/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:S/B:I/M:H/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:E/B:M/M:H/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:E/B:A/M:H/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:P/P:E/B:I/M:H/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:M/B:I/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:S/B:I/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:E/B:M/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:E/B:A/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:N/A:N/T:T/P:E/B:I/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:M/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:S/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:E/B:M/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:E/B:A/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:P/P:E/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:M/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:S/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:E/B:M/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:E/B:A/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:N/A:Y/T:T/P:E/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:M/B:I/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:S/B:I/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:E/B:M/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:E/B:A/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:P/P:E/B:I/M:H/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:M/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:S/B:M/M:M/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:S/B:A/M:M/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:S/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:E/B:M/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:E/B:A/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:N/T:T/P:E/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:M/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:S/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:E/B:M/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:E/B:A/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:P/P:E/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:M/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:S/B:M/M:M/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:S/B:A/M:M/D:R/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:S/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:E/B:M/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:E/B:A/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:P/A:Y/T:T/P:E/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:M/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:S/B:M/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:S/B:A/M:M/D:T/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:S/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:E/B:M/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:E/B:A/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:P/P:E/B:I/M:H/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:M/B:M/M:L/D:T/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:M/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:S/B:M/M:M/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:S/B:A/M:M/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:S/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:E/B:M/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:E/B:A/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:N/T:T/P:E/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:M/B:M/M:L/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:M/B:A/M:M/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:M/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:S/B:M/M:M/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:S/B:A/M:M/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:S/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:E/B:M/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:E/B:A/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:P/P:E/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:M/B:M/M:L/D:A/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:M/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:S/B:M/M:M/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:S/B:A/M:M/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:S/B:I/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:E/B:M/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:E/B:A/M:H/D:C/2025-01-01T00:00:00
SSVCv2/E:A/A:Y/T:T/P:E/B:I/M:H/D:C/2025-01-01T00:00:00
